<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Threat Intelligence Dashboard v2</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Marked.js for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./static/css/dashboard.css?v=2">
    

</head>
<body>
    <a href="#main-content" class="skip-link visually-hidden-focusable">Skip to main content</a>
    <button 
        id="themeToggleBtn" 
        class="theme-toggle-btn" 
        aria-label="Switch theme"
        title="Switch theme"
    >
        <i class="bi bi-moon"></i>
    </button>
    <div id="app" class="main-container">
        <!-- Loading State -->
        <div v-if="loading" class="loading-spinner" role="status" aria-live="polite" aria-busy="true">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>

        <!-- Error State -->
        <div v-else-if="error" class="alert alert-danger" role="alert" aria-live="assertive">
            <i class="bi bi-exclamation-triangle me-2" aria-hidden="true"></i>
            [[ error ]]
        </div>

    <!-- Main Content -->
    <div v-else id="main-content" role="main" tabindex="-1">
            <!-- Dashboard Branding and Disclaimer -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="dashboard-branding d-flex align-items-center" role="alert">
                        <div class="me-3">
                            <i class="bi bi-shield-check" style="font-size: 2rem; color: #ffd700;"></i>
                        </div>
                        <div class="flex-grow-1">
                            <div class="mb-2">
                                <i class="bi bi-robot me-2" style="font-size: 1.5rem; color: #ffd700;"></i>
                                <span class="dashboard-logo">TI DASHBOAR</span>
                                <span class="ms-2" style="color: #ff6b6b; font-size: 1.5rem;">üêó</span>
                                <span class="badge ms-3" style="background: #ff6b6b !important; color: white !important;">AI-GENERATED</span>
                            </div>
                            <p class="mb-1 small mb-0">
                                This cybersecurity threat intelligence dashboard is automatically generated using AI technology. 
                                Data is aggregated from various open-source intelligence feeds.
                            </p>
                            <small>
                                <i class="bi bi-github me-1"></i>
                                <a href="https://github.com/JouniMi/tidashboar.github.io" target="_blank">
                                    View on GitHub
                                </a>
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Industry Selector -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="industry-selector">
                        <label class="form-label fw-bold">
                            <i class="bi bi-building me-2"></i>Select Industry View:
                        </label>
                        <select 
                            class="form-select form-select-lg" 
                            v-model="selectedIndustry" 
                            @change="loadIndustryData"
                            :disabled="loadingIndustry"
                        >
                            <option value="">All Industries (General)</option>
                            <option v-for="industry in industries" :key="industry.id" :value="industry.id">
                                [[ industry.name ]]
                            </option>
                        </select>
                        <small v-if="selectedIndustry" class="text-muted mt-1 d-block">
                            <i class="bi bi-info-circle me-1"></i>
                            Viewing data for [[ getIndustryName(selectedIndustry) ]]. Last updated: [[ industryData?.generated_at || 'Loading...' ]]
                        </small>
                        <small v-else class="text-muted mt-1 d-block">
                            <i class="bi bi-info-circle me-1"></i>
                            Viewing aggregated data across all industries.
                        </small>
                    </div>
                </div>
            </div>

            <!-- Breaking News (general view only) -->
            <breaking-news 
                v-if="!selectedIndustry" 
                :breaking-news="breakingNews">
            </breaking-news>

            <!-- Executive Summary -->
            <executive-summary 
                v-if="selectedIndustry && industryData?.summary"
                :summary="industryData.summary"
                :industry="getIndustryName(selectedIndustry)">
            </executive-summary>
            <executive-summary 
                v-else-if="summaryData.executiveSummary"
                :summary="summaryData.executiveSummary">
            </executive-summary>

            <!-- Industry Stats Cards (when industry selected) -->
            <div v-if="selectedIndustry && industryData?.stats" class="row mb-4">
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="card-body text-center">
                            <div class="stats-icon">
                                <i class="bi bi-file-earmark-text"></i>
                            </div>
                            <div class="stats-value">[[ industryData.stats['7_day']?.total_documents || 0 ]]</div>
                            <div class="stats-label">7-Day Documents</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="card-body text-center">
                            <div class="stats-icon">
                                <i class="bi bi-calendar-month"></i>
                            </div>
                            <div class="stats-value">[[ industryData.stats['30_day']?.total_documents || 0 ]]</div>
                            <div class="stats-label">30-Day Documents</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="card-body text-center">
                            <div class="stats-icon">
                                <i class="bi bi-calendar3"></i>
                            </div>
                            <div class="stats-value">[[ industryData.stats['150_day']?.total_documents || 0 ]]</div>
                            <div class="stats-label">150-Day Documents</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="card-body text-center">
                            <div class="stats-icon">
                                <i class="bi bi-globe"></i>
                            </div>
                            <div class="stats-value">[[ getTopCountry() ]]</div>
                            <div class="stats-label">Top Region</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Cards (general view) -->
            <stats-cards v-else :summary-stats="summaryData" :live-stats="liveStats"></stats-cards>

            <!-- Industry Monthly Trends Chart -->
            <div v-if="selectedIndustry && industryData?.stats?.industry_monthly_trends" class="row mb-4">
                <div class="col-12">
                    <div class="card dashboard-card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="bi bi-graph-up me-2"></i>Industry Monthly Trends</h5>
                        </div>
                        <div class="card-body">
                            <canvas ref="industryTrendsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <ul class="nav nav-tabs mb-4" role="tablist" aria-label="Dashboard navigation">
                <li class="nav-item" role="presentation">
                    <button class="nav-link" :class="{active: activeTab==='overview'}" @click="activeTab='overview'" role="tab" :aria-selected="activeTab==='overview'" aria-controls="overview-panel" id="overview-tab">
                        <span aria-hidden="true"><i class="bi bi-speedometer2 me-1"></i></span> Overview
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" :class="{active: activeTab==='incidents'}" @click="activeTab='incidents'" role="tab" :aria-selected="activeTab==='incidents'" aria-controls="incidents-panel" id="incidents-tab">
                        <span aria-hidden="true"><i class="bi bi-exclamation-triangle me-1"></i></span> Incidents
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" :class="{active: activeTab==='vulnerabilities'}" @click="activeTab='vulnerabilities'" role="tab" :aria-selected="activeTab==='vulnerabilities'" aria-controls="vulnerabilities-panel" id="vulnerabilities-tab">
                        <span aria-hidden="true"><i class="bi bi-bug me-1"></i></span> Vulnerabilities
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" :class="{active: activeTab==='threat-actors'}" @click="activeTab='threat-actors'" role="tab" :aria-selected="activeTab==='threat-actors'" aria-controls="threat-actors-panel" id="threat-actors-tab">
                        <span aria-hidden="true"><i class="bi bi-person-badge me-1"></i></span> Threat Actors
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" :class="{active: activeTab==='analytics'}" @click="activeTab='analytics'" role="tab" :aria-selected="activeTab==='analytics'" aria-controls="analytics-panel" id="analytics-tab">
                        <span aria-hidden="true"><i class="bi bi-bar-chart me-1"></i></span> Analytics
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Overview Tab -->
                <div v-show="activeTab==='overview'" id="overview-panel" role="tabpanel" aria-labelledby="overview-tab" tabindex="-1">
                    <charts-container
                        :summary-data="summaryData"
                        :incidents-data="incidents"
                        :vulnerabilities-data="vulnerabilities"
                        :loading="loading"
                        :error="error"
                        @refresh="loadAllData">
                    </charts-container>
                </div>

                <!-- Incidents Tab -->
                <div v-show="activeTab==='incidents'" id="incidents-panel" role="tabpanel" aria-labelledby="incidents-tab" tabindex="-1">
                    <incidents-table :incidents="incidents" @refresh="loadIncidents"></incidents-table>
                </div>

                <!-- Vulnerabilities Tab -->
                <div v-show="activeTab==='vulnerabilities'" id="vulnerabilities-panel" role="tabpanel" aria-labelledby="vulnerabilities-tab" tabindex="-1">
                    <vulnerabilities-table :vulnerabilities="vulnerabilities" @refresh="loadVulnerabilities"></vulnerabilities-table>
                </div>

                <!-- Threat Actors Tab -->
                <div v-show="activeTab==='threat-actors'" id="threat-actors-panel" role="tabpanel" aria-labelledby="threat-actors-tab" tabindex="-1">
                    <threat-actors-table :threat-actors="threatActors" @refresh="loadThreatActors"></threat-actors-table>
                </div>

                <!-- Analytics Tab -->
                <div v-show="activeTab==='analytics'" id="analytics-panel" role="tabpanel" aria-labelledby="analytics-tab" tabindex="-1">
                    <!-- Executive Summary Cards -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="analytics-card risk-gauge-card">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Overall Risk Level</h6>
                                    <div class="risk-gauge" id="riskGauge"></div>
                                    <span class="risk-label">[[ statisticsData?.risk_assessment?.overall_risk || 'Medium' ]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="analytics-card summary-card">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Total Security Events</h6>
                                    <div class="summary-number">[[ statisticsData?.overall_metrics?.total_security_events || 0 ]]</div>
                                    <small class="text-muted">All categories</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="analytics-card summary-card">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Active Incidents</h6>
                                    <div class="summary-number">[[ statisticsData?.incidents?.total_incidents || 0 ]]</div>
                                    <small class="text-muted">Last 30 days</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="analytics-card summary-card">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Critical Vulnerabilities</h6>
                                    <div class="summary-number">[[ getCriticalVulnCount() ]]</div>
                                    <small class="text-muted">CVSS 9.0-10.0</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Incident Analytics -->
                    <div class="analytics-section">
                        <h5 class="section-title"><i class="bi bi-exclamation-triangle me-2"></i>Incident Analytics</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Incident Types Distribution</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="incidentTypesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Incident Severity Breakdown</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="incidentSeverityChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Incident Timeline (Recent Activity)</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="incidentTimelineChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vulnerability Analytics -->
                    <div class="analytics-section">
                        <h5 class="section-title"><i class="bi bi-bug me-2"></i>Vulnerability Analytics</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>CVSS Score Distribution</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="cvssDistributionChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Top Affected Vendors</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="vendorVulnerabilitiesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Threat Actor Analytics -->
                    <div class="analytics-section">
                        <h5 class="section-title"><i class="bi bi-person-badge me-2"></i>Threat Actor Analytics</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Actor Motivations</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="motivationsChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Geographic Distribution</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="countriesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Top Malware Families</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas ref="malwareFamiliesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Assessment -->
                    <div class="analytics-section">
                        <h5 class="section-title"><i class="bi bi-shield-exclamation me-2"></i>Risk Assessment</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Key Risk Factors</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="risk-factors">
                                            <div v-for="factor in statisticsData?.risk_assessment?.risk_factors" :key="factor" class="risk-factor-item">
                                                <i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>
                                                <span>[[ formatRiskFactor(factor) ]]</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="analytics-card">
                                    <div class="card-header">
                                        <h6>Recommendations</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="recommendations">
                                            <div v-for="rec in statisticsData?.risk_assessment?.recommendations" :key="rec" class="rstatisticsData?.risk_assessment?.recommendations" :key="rec" class="recommendation-item">
                                                <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                <span>[[ formatRecommendation(rec) ]]</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="./static/js/services/api.js"></script>
    <script src="./static/js/services/charts.js"></script>
    <script src="./static/js/services/validator.js"></script>
    <script src="./static/js/services/global-error-handler.js"></script>
    <script src="./static/js/services/theme.js"></script>
    <script src="./static/js/services/utils.js"></script>
    <script src="./static/js/components/executive-summary.js"></script>
    <script src="./static/js/components/breaking-news.js"></script>
    <script src="./static/js/components/stats-cards.js"></script>
    <script src="./static/js/components/incidents-table.js"></script>
    <script src="./static/js/components/vulnerabilities-table.js"></script>
    <script src="./static/js/components/threat-actors-table.js"></script>
    <script src="./static/js/components/charts-container.js"></script>
    <script src="./static/js/components/analytics-dashboard.js"></script>
    <script src="./static/js/app.js"></script>
<!-- 100% privacy-first analytics -->
<script async src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
</body>
</html>
